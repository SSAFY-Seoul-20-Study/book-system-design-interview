- 2의 제곱수
- 모든 프로그래머가 알아야 하는 응답지연 값
- 가용성에 관계된 수치들 
	- 예제  : 트위터 QPS와 저장소 요구량 추정
- 팁
<hr>

**개략적인 규모 추정** (back-of-the-envelope estimation)
: 어떤 설계가 요구사항에 부합하는지를 확인하기 위해 성능 추정치를 계산하는 행위 

# 🍀 2의 제곱수
> 데이터 양을 나타내는 방법 , 데이터 볼륨 단위  

최소 단위는 `1바이트` (=`8비트` = `ASCII 문자 하나의 메모리 크기`)

<img src="https://velog.velcdn.com/images/jinony/post/a7f3ad59-535e-4bea-94a9-842f67d3af74/image.png" width=600>

[컴퓨터의 저장 단위, 용량](https://6987.tistory.com/entry/%EC%BB%B4%ED%93%A8%ED%84%B0%EC%9D%98-%EC%A0%80%EC%9E%A5-%EB%8B%A8%EC%9C%84-%EC%9A%A9%EB%9F%89-%EB%B9%84%ED%8A%B8-%EB%B0%94%EC%9D%B4%ED%8A%B8-GB-TB-PT-ET-ZT-YT)
비트 > 바이트 > 킬로 바이트 > 메가 바이트 > 기가 바이트 > 테라 바이트 > 페타 바이트 > 엑사 바이트 > 제타 바이트 > 요타 바이트 

# 🍀 응답지연(latency) 값 

## Latency ❓

[지연시간 Latency](https://johngrib.github.io/wiki/latency/)

- 일정한 단위의 정보가 시스템을 통과하는데 걸리는 시간을 측정한 값 
- 요청이 처리되길 기다리는 시간, 서비스를 기다리며 휴지(latent) 상태인 시간 
	- `응답 시간`(Response Time) : 요청을 처리하는 실제 시간 외에도 네트워크 지연, 큐 지연 포함 (클라이언트 관점에서 본 시간)
- IP 패킷이 한 지점에서 다른 지점으로 이동하는데 걸리는 시간 
	- `왕복시간`(RTT, Round-Trip Time) : 데이터 패킷이 대상으로 전송되는데 걸리는 시간과 해당 패킷에 대한 승인이 원본에서 다시 수신되는데 걸리는 시간을 더한 것 (지연시간의 2배)
- 어떤 연산(ex. 애플리케이션 요청, 데이터베이스 질의, 파일 시스템 연산 등)이 완료될 때까지 걸리는 시간 
- 어떤 연산이 수행되기 전에 기다려야 하는 시간 
	- '데이터 전송을 위한 네트워크 서비스 요청' 이라는 연산이 일어나기 전,
	  시스템은 네트워크 연결이 만들어지기를 기다려야 하는데 이에 걸리는 시간이 연산의 지연 시간 
	- 지연 시간 + 연산 시간 = 응답 시간 
- 수행할 작업의 존재 여부와 상관없이 모든 유형의 응답을 받는데 걸리는 시간 

## 대략적인 응답지연 값

<img src="https://velog.velcdn.com/images/jinony/post/90d5d3eb-5a85-492c-8ae4-4ceaaeb9aee3/image.png" width=600>

[지난 스터디에서 정리한 캐시](https://ruddy-mule-9a2.notion.site/ec75953dc77d4d208b8e474c521d462f?pvs=4)
[지난 스터디에서 정리한 임계영역 ](https://ruddy-mule-9a2.notion.site/0c286b19e1ea493992c5ac5f8b2f7458?pvs=4)

**📌 기억해야 할 사항**
- 메모리는 빠르지만 디스크 탐색은 느리다. 
- 단순한 압축 알고리즘은 빠르다. 가능하면 데이터를 전송하기 전에 압축해라.
- 데이터 센터 간에 데이터를 주고 받는데에는 시간이 걸린다. 

# 🍀 가용성에 관계된 수치들

## 고가용성❓

[가용성과 고가용성](https://www.stevenjlee.net/2020/06/28/%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-%EA%B0%80%EC%9A%A9%EC%84%B1-availability-%EA%B3%BC-%EA%B3%A0%EA%B0%80%EC%9A%A9%EC%84%B1-high-availability/)

- `가용성` : 서버와 네트워크 또는 프로그램 등의 다양한 정보 시스템이 정상적으로 사용 가능한 정도를 의미 
	- 시스템의 가동률과 비슷한 의미
	- 정상적인 사용 시간을 전체 사용 시간으로 나눈 값으로 표현
	- <img src="https://blog.kakaocdn.net/dn/biXEoF/btq9t66e1vX/76eK9VPxr0tcNUCsnXLIKK/img.png" width=300>

- `고가용성` : 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력 
	- 일반적으로 퍼센트로 고가용성을 표현함
	- 대부분의 서비스는 99%에서 100% 사이의 값 
	- 관습적으로 9를 사용해 표시하므로, 9가 많을수록 좋다고 보면 된다
	- 5 Nines (=99.999%) : 1년 중 5분 15초 이하의 장애 시간을 허용 


## 고가용성을 위한 방법들

**고가용성 솔루션**
- HACMP : High Availability Clustering Multiprocessing
- 각 시스템들을 클러스터로 엮어지게 만든다
- 클러스터로 묶인 2대의 서버들 중 1대의 서버에서 장애가 발생할 경우 다른 서버가 즉시 그 업무를 대신 수행 

**네트워크 연결의 이중화 구성**
- 서로 다른 인터넷 서비스 사업자가 제공하는 네트워크 회선 구축 및 이중화 
- 한 쪽 네트워크 회선에 장애가 발생했을 때도 서비스에 영향이 없도록 구성 가능

**LAG**
- Link Aggregation Group
- 하나의 시스템을 위해 물리적인 회선을 이중화 하여 장애를 대비 
- 서로 다른 두 개의 물리적인 회선을 하나의 논리적인 회선으로 구성하여 대역폭을 추가로 확보
- 동시에, 한 회선의 장애 시에는 다른 하나의 회선으로 계속 정상 통신을 하는 이중화 구성 

**로드밸런서**
- 유입되는 많은 양의 네트워크 트래픽을 여러 목적지로 분산 
- Health Check 기능을 통해 정상적인 상태의 서버로만 연결을 제공 

**RAID 방식의 스토리지**
- Redundant Array of Inexpensive/Independent Disk 
- 여러 개의 저장 장치를 묶어서 하나의 고용량/고성능 저장 장치처럼 사용하는 기술
- 그룹화된 여러 디스크에 같은 내용들을 복제해 두면 하나의 디스크에 장애가 발생하더라도 다른 디스크에 저장되어 있는 내용들로 인해 정보가 손실되지 않음 

## QPS , Query Per Second
> 서비스의 사용자 수, 사용 빈도, 데이터 보관 정책 등을 토대로 대략적인 QPS를 추정해볼 수 있다. 

[QPS와 TPS](https://jjingho.tistory.com/154)

- `QPS` : 초당 서버가 응답할 수 있는 쿼리의 수 
	- 일반적으로 웹 서비스에서 검색 엔진이나 DB와 같은 특정 서버가 처리할 수 있는 트래픽의 수 
- `TPS` : 초당 처리할 수 있는 트랜잭션의 수 
	- 특정 엔티티가 수행한 원자적 동작의 수 
	- 일반적으로 DB의 트랜젝션 수 
	- 클라이언트의 요청 부터 서버 내부의 처리를 거쳐, 응답 까지의 과정이 하나의 TPS
	 
<페이지 방문>
- 하나의 `TPS` 발생
- 게시글 조회, 댓글 조회, 광고 조회, 인기글 조회 등의 4개의 `QPS` 발생 

<회원 가입>
- 하나의 `TPS` 발생 
- 사용자 추가의 1개의 `QPS` 발생 

# 🌹 팁
- **근사치**를 활용해서 계산해라
- **가정**들은 나중을 위해 적어둬라
- **단위**를 붙이는 습관을 통해 모호함을 방지해라
- **QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수** 등을 추정하는 연습을 미리해라.